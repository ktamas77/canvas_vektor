<!DOCTYPE html>
<html>
    <head>
        <title>Canvas/Vektor</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    </head>
    <body>
        <div>
            <canvas id="screen_vertex"></canvas>
            <canvas id="screen_polygon"></canvas>
            <canvas id="screen_mesh"></canvas>
        </div>
        <script src="torus.js"></script>
        <script>            
            var scale = 5;              // normalize object size
            var horizontalShift = 150;  // horizontal center
            var verticalShift = 200;    // vertical center
            
            var sinMax = 1024;
            var multiplier = 32000;
            var sinA = Array();
            var cosA = Array();
            
            // -- init rotation arrays
            var pipi = (sinMax/2)/Math.PI;
            for (var i = 0;i < sinMax; i++) {
                sinA[i] = Math.floor(Math.sin(i/(pipi))*multiplier); 
                cosA[i] = Math.floor(Math.cos(i/(pipi))*multiplier);
            }
            
            function rotateX(sourceObj, angle)
            {
                return targetObj;
            }

            function renderVertex(vertexObj, canvasName)
            {
                canvas = $('#' + canvasName)[0].getContext('2d');
                canvas.fillStyle = '#00f';            
                for (var i in vertexObj) {
                    v = vertexObj[i];
                    x = Math.round(v[2] / scale);
                    y = Math.round(v[3] / scale);
                    canvas.fillRect(x + horizontalShift, y + verticalShift, 2, 2);
                }                
            }
            
            function renderPolygon(vertexObj, faceObj, canvasName)
            {
                var canvas = $('#' + canvasName)[0].getContext('2d');
                canvas.fillStyle = '#f00';            
                for (var i in faceObj) {
                    f = faceObj[i];
                    a = f[2];
                    b = f[3];
                    c = f[4];
                    vertexA = vertex[a];
                    vertexB = vertex[b];
                    vertexC = vertex[c];
                    x1 = vertexA[2] / scale;
                    y1 = vertexA[3] / scale;
                    x2 = vertexB[2] / scale;
                    y2 = vertexB[3] / scale;
                    x3 = vertexC[2] / scale;
                    y3 = vertexC[3] / scale;
                    canvas.beginPath();
                    canvas.moveTo(x1 + horizontalShift, y1 + verticalShift);
                    canvas.lineTo(x2 + horizontalShift, y2 + verticalShift);
                    canvas.lineTo(x3 + horizontalShift, y3 + verticalShift);
                    canvas.closePath();
                    canvas.fill();
                }               
            }
            
            function renderMesh(vertexObj, faceObj, canvasName)
            {
                var canvas = $('#' + canvasName)[0].getContext('2d');
                canvas.fillStyle = '#0f0';            
                canvas.lineWidth = 1;
                for (var i in faceObj) {
                    f = faceObj[i];
                    a = f[2];
                    b = f[3];
                    c = f[4];
                    ab = f[5];
                    bc = f[6];
                    ca = f[7];
                    vertexA = vertexObj[a];
                    vertexB = vertexObj[b];
                    vertexC = vertexObj[c];
                    x1 = vertexA[2] / scale;
                    y1 = vertexA[3] / scale;
                    x2 = vertexB[2] / scale;
                    y2 = vertexB[3] / scale;
                    x3 = vertexC[2] / scale;
                    y3 = vertexC[3] / scale;
                    if (ab) {
                        canvas.beginPath();
                        canvas.moveTo(x1 + horizontalShift, y1 + verticalShift);
                        canvas.lineTo(x2 + horizontalShift, y2 + verticalShift);
                        canvas.stroke();
                    }
                    if (bc) {
                        canvas.beginPath();
                        canvas.moveTo(x2 + horizontalShift, y2 + verticalShift);
                        canvas.lineTo(x3 + horizontalShift, y3 + verticalShift);
                        canvas.stroke();
                    }
                    if (ca) {
                        canvas.beginPath();
                        canvas.moveTo(x3 + horizontalShift, y3 + verticalShift);
                        canvas.lineTo(x1 + horizontalShift, y1 + verticalShift);
                        canvas.stroke();
                    }
                }
                
            }
            
            renderVertex(vertex, 'screen_vertex');
            renderPolygon(vertex, face, 'screen_polygon');
            renderMesh(vertex, face, 'screen_mesh');
            
        </script>
    </body>
</html>
